(deffacts data
  (zvierata afrika lev antilopa slon)
  (zvierata europa medved rys)
  (zvierata azia panda tiger)
)

(deftemplate pridaj
  (slot kontinent)
  (slot zviera)
)

(deftemplate pocet
  (slot kontinent)
  (slot kolko)
)

(defrule nacitaj
  (not (pridaj (kontinent ?)(zviera ?)))
  (not (nacitane))          
  =>
  (assert (nacitane))
  (printout t "kontinent: ")
  (bind ?k (read))
  (printout t "zviera: ")
  (bind ?z (read))
  (assert (pridaj (kontinent ?k) (zviera ?z)))
)

(defrule vloz
  ?p <- (pridaj (kontinent ?k) (zviera ?z))
  ?l <- (zvierata ?k $?zoz)
  =>
  (retract ?l)
  (assert (zvierata ?k ?z $?zoz))
  (retract ?p)
  (assert (vlozene))
)

(defrule spocitaj
  (declare (salience -10))
  (vlozene)
  ?f <- (zvierata ?k $?zoz)
  =>
  (assert (pocet (kontinent ?k) (kolko (length$ $?zoz))))
)

(defrule vypis
  (declare (salience -20))
  (vlozene)
  (zvierata ?k $?zoz)
  (test (or (member$ panda $?zoz) (member$ opica $?zoz)))
  =>
  (printout t "Zoznam: (zvierata " ?k " " $?zoz ")" crlf)
  (printout t "Posledny prvok: " (nth$ (length$ $?zoz) $?zoz) crlf)
)
